<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        CAPI2 error - Missing System Writer on Windows 2008 ::
        misctechmusings.com — notebook for projects, problems, and solution
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="System Writer is missing from the output of vssadmin list writers. The Application Event log is showing Event ID 513 source CAPI2.
Had a hell of a time resolving this issue. Most of the sources point to a permissions issue. However the security log remains error free. The script below is combines a couple suggested fixes. One of the fixed is from the Microsoft KB article 2009272. Other items were found in various forums."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="/capi2-error-missing-system-writer-on-windows-2008/" />





<link rel="stylesheet" href="/assets/style.css" />

<link rel="stylesheet" href="/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="/img/favicon.png" />


<link href="/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CAPI2 error - Missing System Writer on Windows 2008"/>
<meta name="twitter:description" content="System Writer is missing from the output of vssadmin list writers. The Application Event log is showing Event ID 513 source CAPI2.
Had a hell of a time resolving this issue. Most of the sources point to a permissions issue. However the security log remains error free. The script below is combines a couple suggested fixes. One of the fixed is from the Microsoft KB article 2009272. Other items were found in various forums."/>



<meta property="og:title" content="CAPI2 error - Missing System Writer on Windows 2008" />
<meta property="og:description" content="System Writer is missing from the output of vssadmin list writers. The Application Event log is showing Event ID 513 source CAPI2.
Had a hell of a time resolving this issue. Most of the sources point to a permissions issue. However the security log remains error free. The script below is combines a couple suggested fixes. One of the fixed is from the Microsoft KB article 2009272. Other items were found in various forums." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/capi2-error-missing-system-writer-on-windows-2008/" /><meta property="article:section" content="posts" />

<meta property="og:site_name" content="misctechmusings.com" />







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >/misc/tech/musings</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/archive">Archive</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/archive">Archive</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">CAPI2 error - Missing System Writer on Windows 2008</h1>
    <div class="post-meta">
      

      
        <span class="post-author"
          >— Written by Andrew Bounds</span
        >


      
    </div>

    
      <span class="post-tags">
        
          <a href="/tags/windows/">#windows</a>&nbsp;
        
          <a href="/tags/vss/">#vss</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      <p>System Writer is missing from the output of <code>vssadmin list writers</code>. The Application Event log is showing Event ID 513 source CAPI2.</p>
<p>Had a hell of a time resolving this issue. Most of the sources point to a permissions issue. However the security log remains error free.
The script below is combines a couple suggested fixes. One of the fixed is from the Microsoft KB article <a href="http://support.microsoft.com/kb/2009272">2009272</a>. Other items were found in various forums.</p>
<p>Either run the script as is or break it down in parts to show the exact issue. Be sure to restart the cryptographic service if not running the script in its entirety.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-batch" data-lang="batch">:<span style="color:#75715e">:  Reset Reg and Dir ACLs</span>

Takeown /f <span style="color:#e6db74">&#34;</span>%windir%<span style="color:#e6db74">\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files&#34;</span> /a

icacls <span style="color:#e6db74">&#34;</span>%windir%<span style="color:#e6db74">\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files&#34;</span> /grant <span style="color:#e6db74">&#34;NT AUTHORITY\SYSTEM:(RX)&#34;</span>
icacls <span style="color:#e6db74">&#34;</span>%windir%<span style="color:#e6db74">\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files&#34;</span>  /grant <span style="color:#e6db74">&#34;NT Service\trustedinstaller:(F)&#34;</span>
icacls <span style="color:#e6db74">&#34;</span>%windir%<span style="color:#e6db74">\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files&#34;</span>   /grant <span style="color:#e6db74">&#34;BUILTIN\Users:(RX)&#34;</span>
icacls <span style="color:#e6db74">&#34;</span>%windir%<span style="color:#e6db74">\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files&#34;</span> /grant <span style="color:#e6db74">&#34;Administratoren:(RX)&#34;</span>

Takeown /f %windir%\System32\DriverStore /a

icacls %windir%\System32\DriverStore /grant <span style="color:#e6db74">&#34;NT AUTHORITY\SYSTEM:(RX)&#34;</span>
icacls %windir%\System32\DriverStore /grant <span style="color:#e6db74">&#34;NT Service\trustedinstaller:(F)&#34;</span>
icacls %windir%\System32\DriverStore /grant <span style="color:#e6db74">&#34;BUILTIN\Users:(RX)&#34;</span>
icacls %windir%\System32\DriverStore /grant <span style="color:#e6db74">&#34;Administratoren:(RX)&#34;</span>

Regini Registry\Machine\System\CurrentControlSet\services [1 5 7 11 14 17 21]
Regini Registry\Machine\Software\Microsoft\WBEM\CIMOM [1 5 7 11 14 17 21]


:<span style="color:#75715e">: System state backup failed w/ The system writer is not found in the backup</span>
:<span style="color:#75715e">: kb2009272</span>
:<span style="color:#75715e">: vssadmin list writers = &#34;System Writer&#34; missing</span>

Takeown /f %windir%\winsxs\temp\PendingRenames /a

icacls %windir%\winsxs\temp\PendingRenames /grant <span style="color:#e6db74">&#34;NT AUTHORITY\SYSTEM:(RX)&#34;</span>
icacls %windir%\winsxs\temp\PendingRenames /grant <span style="color:#e6db74">&#34;NT Service\trustedinstaller:(F)&#34;</span>
icacls %windir%\winsxs\temp\PendingRenames /grant BUILTIN\Users:(RX)

Takeown /f %windir%\winsxs\filemaps\* /a

icacls %windir%\winsxs\filemaps\*.* /grant <span style="color:#e6db74">&#34;NT AUTHORITY\SYSTEM:(RX)&#34;</span>
icacls %windir%\winsxs\filemaps\*.* /grant <span style="color:#e6db74">&#34;NT Service\trustedinstaller:(F)&#34;</span>
icacls %windir%\winsxs\filemaps\*.* /grant BUILTIN\Users:(RX)


:<span style="color:#75715e">: Restart the Cryptographic Services</span>

net stop cryptsvc
net start cryptsvc
</code></pre></div>
    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/boinc-linux-gpu/">
                  <span class="button__icon">←</span>
                  <span class="button__text">BOINC Linux GPU</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/chrome-socks5-command-line-switch/">
                  <span class="button__text">Chrome socks5 command line switch</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >/misc/tech/musings</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span
          >© 2021 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span
        >
        <span
          >Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span
        >
      </div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
