<!doctype html><html lang=en><head><title>windows ::
misctechmusings.com — notebook for projects, problems, and solution</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://p0rkjello.github.io/tags/windows/><link rel=stylesheet href=https://p0rkjello.github.io/assets/style.css><link rel=stylesheet href=https://p0rkjello.github.io/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://p0rkjello.github.io/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://p0rkjello.github.io/img/favicon.png><link href=https://p0rkjello.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://p0rkjello.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://p0rkjello.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://p0rkjello.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://p0rkjello.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://p0rkjello.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="windows"><meta name=twitter:description content><meta property="og:title" content="windows"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://p0rkjello.github.io/tags/windows/"><link rel=alternate type=application/rss+xml href=/tags/windows/index.xml title=misctechmusings.com></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>/misc/tech/musings</span>
<span class=logo__cursor></span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/archive>Archive</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/archive>Archive</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/batch-script-get-sid/>Batch script - Get SID</a></h1><div class=post-meta><span class=post-date>2019-12-04</span>
<span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/batch/>#batch</a>&nbsp;</span><div class=post-content>Get Windows user/group SID</div><div><a class="read-more button" href=/batch-script-get-sid/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/active-directory-users-and-computers-on-windows-7/>Active directory Users and Computers on Windows 7</a></h1><div class=post-meta></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/dsim/>#dsim</a>&nbsp;</span><div class=post-content>Download the Remote Server Administration Tools for Windows 7.
Note: Windows 7 Professional or better.
Install the software then run the follow commands to enable the AD Users & Computer snapin.
dism /online /enable-feature /featurename:RemoteServerAdministrationTools dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles-AD dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles-AD-DS dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles-AD-DS-SnapIns I received an error when trying to install the snapin directly.
c:\>dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles-AD-DS-SnapIns Deployment Image Servicing and Management tool Version: 6.</div><div><a class="read-more button" href=/active-directory-users-and-computers-on-windows-7/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/capi2-error-missing-system-writer-on-windows-2008/>CAPI2 error - Missing System Writer on Windows 2008</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/vss/>#vss</a>&nbsp;</span><div class=post-content>System Writer is missing from the output of vssadmin list writers. The Application Event log is showing Event ID 513 source CAPI2.
Had a hell of a time resolving this issue. Most of the sources point to a permissions issue. However the security log remains error free. The script below is combines a couple suggested fixes. One of the fixed is from the Microsoft KB article 2009272. Other items were found in various forums.</div><div><a class="read-more button" href=/capi2-error-missing-system-writer-on-windows-2008/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/detect-.net-version-using-internet-explorer/>Detect .NET version using Internet Explorer</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/dotnet/>#dotnet</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/detect-.net-version-using-internet-explorer/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/gpedit.msi-could-not-create-snap-in/>gpedit.msi could not create snap-in</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/gpedit/>#gpedit</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/gpedit.msi-could-not-create-snap-in/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/identification-and-resolution-of-volume-shadow-copy-service-errors/>Identification and resolution of Volume Shadow Copy Service errors</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/vss/>#vss</a>&nbsp;</span><div class=post-content>Identification and resolution of Volume Shadow Copy Service errors Identify the problem writers using vssadmin
vssadmin syntax:
vssadmin list {shadows [/set= [shadow copy set GUID]] | writers | providers} vssadmin delete shadows /for=&lt;ForVolumeSpec> [/oldest | /all | /shadow=&lt;ShadowID>] [/quiet]`&lt;/pre> Let&rsquo;s start off by checking the state of the VSS Writers
C:\vssadmin list writers vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool (C) Copyright 2001 Microsoft Corp. Writer name: 'System Writer' Writer Id: {e8132975-6f93-4464-a53e-1050253ae220} Writer Instance Id: {449e12cf-6b8f-4d75-a821-bc869d6612c4} State: [1] Failed Last error: No error Writer name: 'SqlServerWriter' Writer Id: {a65faa63-5ea8-4ebc-9dbd-a0c4db26912a} Writer Instance Id: {de3b2861-77f6-43f8-8619-64dc9ea2fbcf} State: [1] Stable Last error: No error Writer name: 'MSDEWriter' Writer Id: {f8544ac1-0611-4fa5-b04b-f7ee00b03277} Writer Instance Id: {9036fdfa-05ef-4f7d-9c2f-84fa2f06560a} State: [1] Stable Last error: No error Writer name: 'WMI Writer' Writer Id: {a6ad56c2-b509-4e6c-bb19-49d8f43532f0} Writer Instance Id: {f9f92826-a3d4-486c-ade3-a4201deb8ad2} State: [7] Failed Last error: No error The output above is showing the System and WMI writers in a Failed state.</div><div><a class="read-more button" href=/identification-and-resolution-of-volume-shadow-copy-service-errors/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/nato-phonetic-alphabet-background/>NATO phonetic alphabet background</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content>Communicate clearly using the Nato phonetic alphabet background. It is difficult to accurately convey an asset tag, serial number, model number, etc to a peer or offsite support. Aside from phone clarity there is often accent or language barriers.
If you are using a Microsoft Windows OS you can quickly add the Nato phonetic alphabet to your desktop background. Grab a copy of the Sysinternals tool Bginfo. Then download the nato.</div><div><a class="read-more button" href=/nato-phonetic-alphabet-background/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/persistent-static-route-via-windows-registry/>Persistent static route via Windows registry</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/registry/>#registry</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/route/>#route</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/persistent-static-route-via-windows-registry/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/remove-ghosted-nics/>Remove Ghosted nics</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content>Found a great script for removing ghosted (hidden) NICS on Frank Peter&rsquo;s blog.
Using the Microsoft devcon.exe tool the script compares the output of find and findall. If the matching device count is not equal the additional device is removed.
find - Find devices that match the specific hardware or instance ID. findall - Find devices including those that are not present. The Device Console Utilitu (DevCon) is available from support.</div><div><a class="read-more button" href=/remove-ghosted-nics/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/restart-terminal-services-without-rebooting/>Restart Terminal Services without rebooting</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content>Restart Terminal Services Without Rebooting Microsoft Windows 2003 and lower does not allow you start or stop the Terminal Services service. However if you can&rsquo;t schedule a server reboot there is an alternative.
Download the Sysinternals tool Process Explorer Using Process Explorer locate the svchost.exe -k termsvcs process. There will be a number of running svchost.exe processes. Hover your mouse over them to identify the correct one. Once you find it, right click and kill it.</div><div><a class="read-more button" href=/restart-terminal-services-without-rebooting/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/system-volume-information-folder-size/>System Volume Information folder size</a></h1><div class=post-meta></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/vss/>#vss</a>&nbsp;</span><div class=post-content>Reduce the size of your System Volume Information folder by shrinking the shadow storage.
Use vssadmin list shadowstorage to list the current Shadow Copy Storage size.
C:\>vssadmin list shadowstorage vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool (C) Copyright 2001-2005 Microsoft Corp. Shadow Copy Storage association For volume: (C:)\\?\Volume{278ce142-19d8-11e1-9176-806e6f6e6963}\ Shadow Copy Storage volume: (C:)\\?\Volume{278ce142-19d8-11e1-9176-806e6f6e69 63}\ Used Shadow Copy Storage space: 15.681 GB (39%) Allocated Shadow Copy Storage space: 16.</div><div><a class="read-more button" href=/system-volume-information-folder-size/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/tail-files-with-powershell/>Tail files with Powershell</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/powershell/>#powershell</a>&nbsp;</span><div class=post-content>For those note aware of the GNU Tail utility, it will print the last n lines of text from a file. It is an invaluable tool for monitoring log files.
Since Windows does not have an equivalent command this is quite useful. Using the Powershell Get-Content cmdlet will print the contents of a file. The -wait parameter will print additional lines as they are added.
Get-Content filename -wait Be aware that this is slow on large files.</div><div><a class="read-more button" href=/tail-files-with-powershell/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/thumb-drive-toolkit/>Thumb drive toolkit</a></h1><div class=post-meta></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/thumbdrive/>#thumbdrive</a>&nbsp;</span><div class=post-content>A Windows Administrator USB toolkit. The following is a collection of free and/or open source tools I like to keep on hand.
Portable Apps collection PortableApps.com Suite™ is a complete collection of portable apps including a web browser, email client, office suite, calendar/scheduler, instant messaging client, antivirus, audio player, sudoku game, password manager, PDF reader, minesweeper clone, backup utility and integrated menu, all preconfigured to work portably. Just drop it on your portable device and you&rsquo;re ready to go.</div><div><a class="read-more button" href=/thumb-drive-toolkit/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/tsm-invalid-file-handle-passed/>TSM Invalid file handle passed</a></h1><div class=post-meta></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/tsm/>#tsm</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/tsm-invalid-file-handle-passed/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/turn-off-windows-firewall-using-netsh/>Turn off Windows firewall using netsh</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/netsh/>#netsh</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/turn-off-windows-firewall-using-netsh/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/using-winsat-to-test-hard-drive-performance/>Using Winsat to test hard drive performance</a></h1><div class=post-meta></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/winsat/>#winsat</a>&nbsp;</span><div class=post-content>The Windows Assessment Tool (WinSAT) is included Microsoft Vista and Windows 7. This tool can perform performance tests including CPU, memory, disk and video.
winsat disk -drive c Windows System Assessment Tool > Running: Feature Enumeration '' > Run Time 00:00:00.00 > Running: Storage Assessment '-drive c -seq -read' > Run Time 00:00:05.48 > Running: Storage Assessment '-drive c -ran -read' > Run Time 00:00:06.99 > Running: Storage Assessment '-drive c -scen 2009' > Run Time 00:01:13.</div><div><a class="read-more button" href=/using-winsat-to-test-hard-drive-performance/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/windows-2003-hung-saving-your-settings/>Windows 2003 hung saving your settings</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content>Every so often I will run into the error where a Windows 2003 server will get stuck logging off a user. The console screen will display the message &ldquo;Saving your settings&rdquo;.
I ran into this issue while needing to remotely reboot a server. The server in question did not have any kind of remote access card. However, the server was running RAdmin software and I was able to get a console screen open.</div><div><a class="read-more button" href=/windows-2003-hung-saving-your-settings/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/windows-2008-access-denied-killing-a-process/>Windows 2008 access denied killing a process</a></h1><div class=post-meta></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content>There are multiple times where I have been unable to kill a process on Windows 2008 server. Generally the process is running as a domain account. Killing the process failed using an administrative prompt and/or the account the process was started with.
The process is owned by the System account. You can use the Sysinternals tool psexec with the -s switch to run as the System account. The -i switch allows the process to interact with the desktop.</div><div><a class="read-more button" href=/windows-2008-access-denied-killing-a-process/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/windows-2008-telnet-client/>Windows 2008 telnet client</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/telnet/>#telnet</a>&nbsp;
<a href=https://p0rkjello.github.io/tags/pkgmgr/>#pkgmgr</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/windows-2008-telnet-client/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/windows-7-godmode/>Windows 7 GodMode</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content></div><div><a class="read-more button" href=/windows-7-godmode/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=https://p0rkjello.github.io/windows-update-error-missing-advpack.dll/>Windows Update error - Missing advpack.dll</a></h1><div class=post-meta><span class=post-author>— Written by Andrew Bounds</span></div><span class=post-tags><a href=https://p0rkjello.github.io/tags/windows/>#windows</a>&nbsp;</span><div class=post-content>Ran into an issue with Microsoft Windows Update Service on two Windows 2003 servers. I use a 3rd party patch management tool that calls the Windows Update API. This issue was preventing the correct list of vulnerabilities and causing Windows Update to error out. One of the servers would report Error number: 0x8DDD0004 the other reported an ActiveX issue.
While exploring solutions I ran into the following error message when opening Add/Remove Windows Components via appwiz.</div><div><a class="read-more button" href=/windows-update-error-missing-advpack.dll/>Read more →</a></div></div><div class=pagination><div class=pagination__buttons><span class="button next"><a href=/tags/windows/page/2/><span class=button__text>Older posts</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>/misc/tech/musings</span>
<span class=logo__cursor></span></a><div class=copyright><span>© 2023 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://p0rkjello.github.io/assets/main.js></script>
<script src=https://p0rkjello.github.io/assets/prism.js></script></div></body></html>